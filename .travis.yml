sudo: required
language: node_js
node_js:
  - "8"

services:
  - docker

cache: yarn
install: yarn

before_script:
  # workaround as travis use ubuntu/trusty which has mysql but our docker need 3306 for mariadb
  - sudo /etc/init.d/mysql stop

script: 
  - yarn test
  - yarn link
  - cd ./tests
  - docker-compose up -d
  - wait 4
  - ./wait_for_db.sh
  - docker-compose ps
  - docker exec sql-mariadb mysql -utest -ptest -e "show databases;"


